<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile-update</title>

    <!-- Favicon -->
<link rel="icon" href="https://k-jobgo-profile-photos-seoul.s3.ap-northeast-2.amazonaws.com/img/favicon.png" />
    <!-- CSS: 등록 페이지와 동일한 profile.css 사용 -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" th:href="@{/css/layout.css}">
    <link rel="stylesheet" th:href="@{/css/toggle.css}">
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <link rel="stylesheet" th:href="@{/css/login.css}">
    <link rel="stylesheet" th:href="@{/css/profileDetail.css}"/>
     <link rel="stylesheet" th:href="@{/css/profile.css}"/>
</head>

<body class="all-page" th:attr="data-is-admin=${isAdmin}">
<header class="top-var">
<div class="brand-header">
  <div class="logo-slogan">
    <img src="/img/favicon.png" class="logo" alt="K-jobgo | 외국인 인재 매칭 플랫폼" />
    <p class="about-slogan"> KOREAMSA Inc.</p>
  </div>
      <!-- SEO 및 브랜드 노출 -->
    <div class="company-info">
      <p class="sr-only">(주)한국경영지원사업단</p>
    </div>
</div>
<div class="menu-wrapper">
	    <!-- 로그인 상태 라벨 -->
  <div class="login-info">
    <span th:if="${isAdmin}" th:text="${adminName + '님'}"></span>
    <button id="loginBtn" th:text="${isAdmin} ? '로그아웃' : '로그인'"></button>
  </div>
  
  <div class="menu-toggle" onclick="toggleMenu()">☰</div>

  <!-- 토글 메뉴 -->
  <div id="menu" class="menu-popup hidden-menu">
    <ul>
    <!-- <li onclick="location.href='/PartnerCompanyInsight'">Partner Company Insight</li> -->
      <li onclick="alert('페이지 준비 중입니다.')">Partner Company Insight</li>
      <li onclick="alert('페이지 준비 중입니다.')">Q&A board</li>

      <!-- 관리자 전용 -->
      <li th:if="${isAdmin}" class="menu-divider"></li>
      <li th:if="${isAdmin}" class="admin-label">관리자 전용</li>
      <li th:if="${isAdmin}" onclick="location.href='/admin/profileList'">프로필 전체 보기</li>
    </ul>
  </div>
</div>  
</header>

  <!-- ✅ K-jobgo 로고 전용 중앙 박스 (about-section 위에 배치) -->
<div class="center-kjobgo-logo">
<a th:href="@{/}">
  <img src="/img/k-jobgo_company.png" alt="K-jobgo | 외국인 인재 매칭 플랫폼" class="k-jobgologo" />
</a>
</div>

<!-- 수정페이지 전체 래퍼 -->
<div class="profile-update">
    <h1>인재 프로필 수정</h1>

    <div class="notice-required">
        <p>※ <strong>기본정보는 필수 항목</strong>입니다.</p>
    </div>

    <div class="profile-box">
        <!-- 사진 영역 -->
        <div class="photo-area">
            <img th:if="${profileDto.profile.photoUrl}" th:src="${profileDto.profile.photoUrl}" id="pofilePhoto" alt="프로필 사진"
            style="width: 150px; height: 200px; object-fit: cover;" />
            <div th:if="${profileDto.profile.photoUrl == null}" id="pofilePhoto_" style="width:150px; height:200px; background:#eee; 
            border:1px solid #ddd; display:flex; align-items:center; justify-content:center;">
                사진 없음
            </div>
             <!--  
            <p th:text="'Debug: ' + ${profileDto.profile.photoUrl}"></p>디버깅용 -->
        </div>

        <!-- 기본정보 -->
        <div class="profile-info">
            <div class="row-group">
                <label>한국 이름:</label>
                <input type="text" th:value="${profileDto.profile.nameKor}" readonly />
            </div>
            <div class="row-group">
                <label>현지 이름:</label>
                <input type="text" th:value="${profileDto.profile.nameOrigin}" readonly />
            </div>
            <div class="row-group">
                <label>성별:</label>
                <label><input type="radio" disabled th:checked="${profileDto.profile.gender == '남성'}" /> 남성</label>
                <label><input type="radio" disabled th:checked="${profileDto.profile.gender == '여성'}" /> 여성</label>
            </div>
            <div class="row-group">
                <label>비자 종류:</label>
                <input type="text" th:value="${profileDto.profile.visaType}" readonly />
            </div>
            <div class="row-group">
                <label>비자 만기일:</label>
                <input type="date" th:value="${profileDto.profile.visaExpire}" readonly />
                <label><input type="checkbox" disabled th:checked="${profileDto.profile.visaExtendable}" /> 연장 가능</label>
            </div>
        </div>

        <!-- 추가정보: 이메일, 연락처, 주소, 체크박스 -->
        <div class="profile-sub-info">
		<!-- 이메일 파트 -->
		<div class="email-group">
		  <label>이메일:</label>
		  <input type="text" th:value="${profileDto.profile.emailId}" readonly />
		  <span>@</span>
		  <input type="text" th:value="${profileDto.profile.emailDomain}" readonly />
		</div>
		
		<!-- 전화번호 파트 -->
		<div class="phone-group">
		  <label>휴대전화:</label>
		  <input type="text" th:value="${profileDto.profile.phone1}" readonly maxlength="3" />
		  <span>-</span>
		  <input type="text" th:value="${profileDto.profile.phone2}" readonly maxlength="4" />
		  <span>-</span>
		  <input type="text" th:value="${profileDto.profile.phone3}" readonly maxlength="4" />
		</div>
            
            <div class="address-group">
                <label>주소:</label>
                <input type="text" th:value="${profileDto.profile.address}" readonly />
            </div>
            <div class="checkbox-group">
                <label><input type="checkbox" disabled th:checked="${profileDto.profile.drivingLicense}" /> 운전면허 있음</label>
                <label><input type="checkbox" disabled th:checked="${profileDto.profile.dormitory}" /> 기숙사 필요</label>
            </div>
        </div>
    </div>

    <!-- 인적사항 -->
    <div class="section personal-section">
        <h3>인적사항</h3>

        <div class="row">
            <label>국적:</label>
            <input type="text" name="personalInfo.nationality" th:value="${personalInfo.nationality}" />
        </div>

        <div class="row row-bodyinfo">
            <label>나이:</label>
            <input type="number" name="personalInfo.age" th:value="${personalInfo.age}" />

            <label>키:</label>
            <div class="input-unit">
                <input type="number" name="personalInfo.height" th:value="${personalInfo.height}" />
                <span class="unit">cm</span>
            </div>

            <label>몸무게:</label>
            <div class="input-unit">
                <input type="number" name="personalInfo.weight" th:value="${personalInfo.weight}" />
                <span class="unit">kg</span>
            </div>
        </div>

        <div class="row row-entry-topik">
            <label>최초 입국일:</label>
            <input type="date" name="personalInfo.firstEntry"
                   th:value="${#temporals.format(personalInfo.firstEntry, 'yyyy-MM-dd')}" />

            <label>TOPIK:</label>
            <select name="personalInfo.topikLevel">
                <option value="등급" th:selected="${personalInfo.topikLevel == '등급'}">등급</option>
                <option value="상" th:selected="${personalInfo.topikLevel == '상'}">상</option>
                <option value="중" th:selected="${personalInfo.topikLevel == '중'}">중</option>
                <option value="하" th:selected="${personalInfo.topikLevel == '하'}">하</option>
            </select>
        </div>

        <div class="row row-salary-location">
            <label for="expectedSalary">희망 급여:</label>
            <select name="personalInfo.expectedSalary" id="expectedSalary">
                <option value="급여 선택" th:selected="${personalInfo.expectedSalary == '급여 선택'}">급여 선택</option>
                <option value="0~200" th:selected="${personalInfo.expectedSalary == '0~200'}">0~200</option>
                <option value="200~250" th:selected="${personalInfo.expectedSalary == '200~250'}">200~250</option>
                <option value="250~300" th:selected="${personalInfo.expectedSalary == '250~300'}">250~300</option>
                <option value="300~350" th:selected="${personalInfo.expectedSalary == '300~350'}">300~350</option>
                <option value="350~400" th:selected="${personalInfo.expectedSalary == '350~400'}">350~400</option>
                <option value="400~" th:selected="${personalInfo.expectedSalary == '400~'}">400~</option>
                <option value="급여 협의" th:selected="${personalInfo.expectedSalary == '급여 협의'}">급여 협의</option>
            </select>
            <span class="unit-label">만원</span>

            <label for="desiredLocation">희망 근무 지역:</label>
            <select name="personalInfo.desiredLocation" id="desiredLocation">
                <option value="지역" th:selected="${personalInfo.desiredLocation == '지역'}">지역</option>
                <option value="서울" th:selected="${personalInfo.desiredLocation == '서울'}">서울</option>
                <option value="경기" th:selected="${personalInfo.desiredLocation == '경기'}">경기</option>
                <option value="인천" th:selected="${personalInfo.desiredLocation == '인천'}">인천</option>
                <option value="대전" th:selected="${personalInfo.desiredLocation == '대전'}">대전</option>
                <option value="세종" th:selected="${personalInfo.desiredLocation == '세종'}">세종</option>
                <option value="충남" th:selected="${personalInfo.desiredLocation == '충남'}">충남</option>
                <option value="충북" th:selected="${personalInfo.desiredLocation == '충북'}">충북</option>
                <option value="광주" th:selected="${personalInfo.desiredLocation == '광주'}">광주</option>
                <option value="전남" th:selected="${personalInfo.desiredLocation == '전남'}">전남</option>
                <option value="전북" th:selected="${personalInfo.desiredLocation == '전북'}">전북</option>
                <option value="대구" th:selected="${personalInfo.desiredLocation == '대구'}">대구</option>
                <option value="경북" th:selected="${personalInfo.desiredLocation == '경북'}">경북</option>
                <option value="부산" th:selected="${personalInfo.desiredLocation == '부산'}">부산</option>
                <option value="경남" th:selected="${personalInfo.desiredLocation == '경남'}">경남</option>
                <option value="울산" th:selected="${personalInfo.desiredLocation == '울산'}">울산</option>
                <option value="강원" th:selected="${personalInfo.desiredLocation == '강원'}">강원</option>
                <option value="제주" th:selected="${personalInfo.desiredLocation == '제주'}">제주</option>
                <option value="전국" th:selected="${personalInfo.desiredLocation == '전국'}">전국</option>
            </select>
        </div>
    </div>


<!-- 학력사항 -->
<div class="section" id="education-section">
  <h3>학력사항</h3>

  <!-- ✅ 항목 제목 라벨 (기간 / 학교명 / 학과 / 졸업 여부) -->
  <div class="edu-header row-group" style="display: flex; gap: 10px; font-weight: bold; margin-bottom: 5px;">
    <label style="width: 220px;">- 기간 -</label>
    <label style="width: 210px;">- 학교명 -</label>
    <label style="width: 200px;">- 학과 -</label>
  </div>

  <!-- 값 있는 엔트리만 반복 -->
  <div th:each="edu,iterStat : ${profileDto.educationList.?[
        (period     != null and period     != '') or
        (schoolName != null and schoolName != '') or
        (major      != null and major      != '')
  ]}"
       class="edu-entry">
    <input type="text" th:value="${edu.period}"       readonly placeholder="기간" />
    <input type="text" th:value="${edu.schoolName}"   readonly placeholder="학교명" />
    <input type="text" th:value="${edu.major}"        readonly placeholder="학과" />

    <!-- 졸업 vs 재학중 -->
    <label>
      <input type="radio"
             disabled
             th:attr="name=${'educationList[' + iterStat.index + '].status'}"
             th:value="'graduated'"
             th:checked="${edu.status == 'graduated'}" />
      졸업
    </label>
    <label>
      <input type="radio"
             disabled
             th:attr="name=${'educationList[' + iterStat.index + '].status'}"
             th:value="'enrolled'"
             th:checked="${edu.status == 'enrolled'}" />
      재학중
    </label>
  </div>
</div>


<!-- 경력사항 -->
<div class="section" id="work-section">
  <h3>경력사항</h3>

  <!-- ✅ 항목 제목 라벨 (기간 / 회사명 / 담당 업무) -->
  <div class="work-header" style="display: flex; gap: 10px; font-weight: bold; margin-bottom: 5px;">
    <label style="width: 220px;">- 기간 -</label>
    <label style="width: 210px;">- 회사명 -</label>
    <label style="width: 200px;">- 담당 업무 -</label>
  </div>

  <!-- 필드 하나라도 값이 있는 요소만 필터링한 리스트가 비었는지 체크 -->
  <div th:if="${#lists.isEmpty(profileDto.workList.?[period != null or companyName != null or jobResponsibility != null])}"> 
    <p>없음</p>
  </div>

  <!-- 값이 있는 엔트리만 반복 출력 -->
  <div th:each="work : ${profileDto.workList.?[period != null or companyName != null or jobResponsibility != null]}"
       class="work-entry">
      <input type="text"  th:value="${work.period}" readonly placeholder="기간" />
      <input type="text"  th:value="${work.companyName}"  readonly placeholder="회사명" />
      <input type="text"  th:value="${work.jobResponsibility}"  readonly  placeholder="담당 업무" />
  </div>
</div>



<!-- 특이사항 -->
<div class="section">
  <h3>특이사항</h3>
  <p th:if="${profileDto.profile.strengths == null or #strings.isEmpty(profileDto.profile.strengths)}">없음</p>
  <p th:unless="${profileDto.profile.strengths == null or #strings.isEmpty(profileDto.profile.strengths)}"
     th:text="${profileDto.profile.strengths}">특이사항</p>
</div>

    <!-- 타임스탬프 -->
    <p class="timestamp">등록일: <span th:text="${#temporals.format(profileDto.profile.createdAt,'yyyy-MM-dd HH:mm')}"></span></p>
    <p class="timestamp">수정일: <span th:text="${#temporals.format(profileDto.profile.updatedAt,'yyyy-MM-dd HH:mm')}"></span></p>

    <!-- 버튼 그룹 -->
<div class="btn-group">
  <!-- 왼쪽 버튼 -->
  <div class="btn-left">
    <a th:href="@{/admin/profileList}" class="btn" id="ListBtn">목록</a>
  </div>
  <!-- 오른쪽 버튼들 -->
  <div class="btn-right">
       <button class="btn" id="saveBtn" type="submit" style="display: none;">완료</button>
      <button type="submit" class="btn" id="cancelBtn" onclick="return confirm('정말 취소하시겠습니까?')">취소</button>
  </div>
</div>
</div>
<footer class="foot-var">
    <div>
        <p>
            <span>(주)한국경영지원사업단  대표이사 : 이준희 <span class="divider">|</span> 사업자등록번호 : 887-81-00124</span><br>
            본사_경기도 김포시 김포한강4로 125 월드타워 705호 <span class="divider">|</span> 본부_경기도 광명시 일직로 43 GIDC A1706호<br>
            국내지사_김해지사, 대구지사, 천안지사, 광주지사, 원주지사 <span class="divider">|</span>
            해외지사_베트남, 필리핀, 인도네시아, 인도, 몽골, 네팔, 우즈베키스탄<br>
            유료직업소개업 등록번호 : 제2025-4090515-14-5-00012호 <span class="divider">|</span>
            Tel_ 031-983-0942 <span class="divider">|</span> Fax_ 031-624-1540 <span class="divider">|</span> Email_ k-jobgo@naver.com<br>
            © 2025 K-jobgo. All rights reserved.
        </p>
    </div>
</footer>

<!-- JS 연결 (등록 페이지와 동일) -->
<script th:src="@{/js/common.js}"></script>
<script th:src="@{/js/login.js}"></script>
<script th:src="@{/js/profile.js}"></script>
</body>
</html>
