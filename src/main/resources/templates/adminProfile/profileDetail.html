<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile-detail</title>
    
<link rel="icon" href="https://k-jobgo-profile-photos-seoul.s3.ap-northeast-2.amazonaws.com/img/favicon.png" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" th:href="@{/css/layout.css}">
    <link rel="stylesheet" th:href="@{/css/toggle.css}">
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <link rel="stylesheet" th:href="@{/css/login.css}">
    <link rel="stylesheet" th:href="@{/css/profileDetail.css}"/>
</head>

<body class="all-page" th:attr="data-is-admin=${isAdmin}">

<header class="top-var">
<div class="brand-header">
  <div class="logo-slogan">
    <img src="/img/favicon.png" class="logo" alt="K-jobgo | 외국인 인재 매칭 플랫폼"/>
    <p class="about-slogan"> KOREAMSA Inc.</p>
  </div>
      <!-- SEO 및 브랜드 노출 -->
    <div class="company-info">
      <p class="sr-only">(주)한국경영지원사업단</p>
    </div>
</div>
<div class="menu-wrapper">
	    <!-- 로그인 상태 라벨 -->
  <div class="login-info">
    <span th:if="${isAdmin}" th:text="${adminName + '님'}"></span>
    <button id="loginBtn" th:text="${isAdmin} ? '로그아웃' : '로그인'"></button>
  </div>
  
  <div class="menu-toggle" onclick="toggleMenu()">☰</div>

  <!-- 토글 메뉴 -->
  <div id="menu" class="menu-popup hidden-menu">
    <ul>
    <!-- <li onclick="location.href='/PartnerCompanyInsight'">Partner Company Insight</li> -->
      <li onclick="alert('페이지 준비 중입니다.')">Partner Company Insight</li>
      <li onclick="alert('페이지 준비 중입니다.')">Q&A board</li>

      <!-- 관리자 전용 -->
      <li th:if="${isAdmin}" class="menu-divider"></li>
      <li th:if="${isAdmin}" class="admin-label">관리자 전용</li>
      <li th:if="${isAdmin}" onclick="location.href='/admin/profileList'">프로필 전체 보기</li>
    </ul>
  </div>
</div>  
</header>

  <!-- ✅ K-jobgo 로고 전용 중앙 박스 (about-section 위에 배치) -->
<div class="center-kjobgo-logo">
<a th:href="@{/}">
  <img src="/img/k-jobgo_company.png" alt="K-jobgo | 외국인 인재 매칭 플랫폼" class="k-jobgologo" />
</a>
</div>

<form class="updateform" id="updateForm" th:action="@{/admin/profileUpdate}" method="post" enctype="multipart/form-data">

<div class="profile-detail">
    <h1>인재 프로필</h1>
    <div class="notice-required">
        <p>※ <strong>기본정보는 필수 항목</strong>입니다.</p>
    </div>
    <div class="profile-box">
        <!-- 사진 영역 -->
        <div class="photo-area">
            <img th:if="${profileDto.profile.photoUrl}" th:src="${profileDto.profile.photoUrl}"
                 id="profilePhoto" alt="프로필 사진"
                 style="width: 150px; height: 200px; object-fit: cover;" />
            <div th:if="${profileDto.profile.photoUrl == null}" id="profilePhoto_"
                 style="width:150px; height:200px; background:#eee; border:1px solid #ddd;
                 display:flex; align-items:center; justify-content:center;">
                사진 없음
            </div>
            <input type="file" name="photo" id="photoInput" accept="image/*" style="display: none;" />
            <input type="hidden" name="profile.photoUrl" th:value="${profileDto.profile.photoUrl}" />
            <button type="button" id="changePhotoBtn" style="display:none; margin-top: 5px;">사진 변경</button>
        </div>
        <!-- 기본정보 -->
        <div class="profile-info">
            <div class="row-group">
                <label>한국 이름:</label>
                <input type="text"  name="profile.nameKor" th:value="${profileDto.profile.nameKor}" readonly />
            </div>
            <div class="row-group">
                <label>현지 이름:</label>
                <input type="text" name="profile.nameOrigin" th:value="${profileDto.profile.nameOrigin}" readonly />
            </div>
            <div class="row-group">
                <label>성별:</label>
                <label><input type="radio" value="남성" name="profile.gender" disabled th:checked="${profileDto.profile.gender == '남성'}" /> 남성</label>
                <label><input type="radio" value="여성" name="profile.gender" disabled th:checked="${profileDto.profile.gender == '여성'}" /> 여성</label>
            </div>
            <div class="row-group">
                <label>비자 종류:</label>
                <input type="text" name="profile.visaType"  th:value="${profileDto.profile.visaType}" readonly />
            </div>
            <div class="row-group">
                <label>비자 만기일:</label>
                <input type="date" name="profile.visaExpire" th:value="${profileDto.profile.visaExpire}" readonly />
                <label><input type="checkbox" name="profile.visaExtendable" disabled th:checked="${profileDto.profile.visaExtendable}" /> 연장 가능</label>
            </div>
        </div>
        <!-- 추가정보: 이메일, 연락처, 주소, 체크박스 -->
        <div class="profile-sub-info">
            <div class="email-group">
              <label>이메일:</label>
              <input type="text" name="profile.emailId" th:value="${profileDto.profile.emailId}" readonly />
              <span>@</span>
              <input type="text" name="profile.emailDomain" th:value="${profileDto.profile.emailDomain}" readonly />
            </div>
            <div class="phone-group">
              <label>핸드폰 번호:</label>
              <input type="text" name="profile.phone1" th:value="${profileDto.profile.phone1}" readonly maxlength="3" />
              <span>-</span>
              <input type="text" name="profile.phone2" th:value="${profileDto.profile.phone2}" readonly maxlength="4" />
              <span>-</span>
              <input type="text" name="profile.phone3" th:value="${profileDto.profile.phone3}" readonly maxlength="4" />
            </div>
            <div class="address-group">
                <label>주소:</label>
                <input type="text" name="profile.address" th:value="${profileDto.profile.address}" readonly />
            </div>
            <div class="checkbox-group">
                <label><input type="checkbox" name="profile.drivingLicense" disabled th:checked="${profileDto.profile.drivingLicense}" /> 운전면허 있음</label>
                <label><input type="checkbox" name="profile.dormitory" disabled th:checked="${profileDto.profile.dormitory}" /> 기숙사 필요</label>
            </div>
        </div>
    </div>
    <!-- 인적사항 -->
    <div class="section personal-section">
        <h3>인적사항</h3>
        <div class="row">
            <label>국적:</label>
            <input type="text" name="personalInfo.nationality" th:value="${profileDto.personalInfo?.nationality}" readonly />
        </div>
        <div class="row row-bodyinfo">
            <label>나이:</label>
            <input type="number" name="personalInfo.age" th:value="${profileDto.personalInfo?.age}" readonly />
            <label>키:</label>
            <div class="input-unit">
                <input type="number" name="personalInfo.height" th:value="${profileDto.personalInfo?.height}" readonly />
                <span class="unit">cm</span>
            </div>
            <label>몸무게:</label>
            <div class="input-unit">
                <input type="number" name="personalInfo.weight" th:value="${profileDto.personalInfo?.weight}" readonly />
                <span class="unit">kg</span>
            </div>
        </div>
        <div class="row row-entry-topik">
            <label>최초 입국일:</label>
            <input type="date" name="personalInfo.firstEntry"  th:value="${profileDto.personalInfo?.firstEntry}" readonly />
            <label>TOPIK:</label>
            <select name="personalInfo.topikLevel" disabled >
              	<option value="등급" th:selected="${profileDto.personalInfo?.topikLevel==''}">등급</option>
                <option value="상" th:selected="${profileDto.personalInfo?.topikLevel=='상'}">상</option>
                <option value="중" th:selected="${profileDto.personalInfo?.topikLevel=='중'}">중</option>
                <option value="하" th:selected="${profileDto.personalInfo?.topikLevel=='하'}">하</option>
            </select>
        </div>
        <div class="row row-salary-location">
            <label>희망 급여:</label>
            <select name="personalInfo.expectedSalary" disabled>
             	 <option value="" th:selected="${profileDto.personalInfo?.expectedSalary=='급여 선택'}">급여 선택</option>
                <option value="0~200" th:selected="${profileDto.personalInfo?.expectedSalary=='0~200'}">0~200</option>
                <option value="200~250" th:selected="${profileDto.personalInfo?.expectedSalary=='200~250'}">200~250</option>
                <option value="250~300"th:selected="${profileDto.personalInfo?.expectedSalary=='250~300'}">250~300</option>
                <option value="300~350"th:selected="${profileDto.personalInfo?.expectedSalary=='300~350'}">300~350</option>
                <option value="350~400"th:selected="${profileDto.personalInfo?.expectedSalary=='350~400'}">350~400</option>
                <option value="400~"th:selected="${profileDto.personalInfo?.expectedSalary=='400~'}">400~</option>
			    <option value="급여 협의" th:selected="${profileDto.personalInfo?.expectedSalary=='급여 협의'}">급여 협의</option>
            </select>
            <span class="unit-label">만원</span>
            <label>희망 근무 지역:</label>
            <select name="personalInfo.desiredLocation" disabled>
            	<option th:selected="${profileDto.personalInfo?.desiredLocation=='지역'}">지역</option>
                <option th:selected="${profileDto.personalInfo?.desiredLocation=='서울'}">서울</option>
                <option th:selected="${profileDto.personalInfo?.desiredLocation=='경기'}">경기</option>
                <option th:selected="${profileDto.personalInfo?.desiredLocation=='인천'}">인천</option>
                <option th:selected="${profileDto.personalInfo?.desiredLocation=='대전'}">대전</option>
                 <option th:selected="${profileDto.personalInfo?.desiredLocation=='세종'}">세종</option>
                 <option th:selected="${profileDto.personalInfo?.desiredLocation=='충남'}">충남</option>
                <option th:selected="${profileDto.personalInfo?.desiredLocation=='충북'}">충북</option>
                 <option th:selected="${profileDto.personalInfo?.desiredLocation=='광주'}">광주</option>
                <option th:selected="${profileDto.personalInfo?.desiredLocation=='전남'}">전남</option>
                <option th:selected="${profileDto.personalInfo?.desiredLocation=='전북'}">전북</option>
                <option th:selected="${profileDto.personalInfo?.desiredLocation=='대구'}">대구</option>
                <option th:selected="${profileDto.personalInfo?.desiredLocation=='경북'}">경북</option>
                <option th:selected="${profileDto.personalInfo?.desiredLocation=='부산'}">부산</option>
                <option th:selected="${profileDto.personalInfo?.desiredLocation=='경남'}">경남</option>
                <option th:selected="${profileDto.personalInfo?.desiredLocation=='울산'}">울산</option>
                <option th:selected="${profileDto.personalInfo?.desiredLocation=='강원'}">강원</option>        
				 <option th:selected="${profileDto.personalInfo?.desiredLocation=='제주'}">제주</option> 
 				 <option th:selected="${profileDto.personalInfo?.desiredLocation=='전국'}">전국</option>                                                                                                                                                                                                                                                
            </select>
        </div>
    </div>

    <!-- 학력사항 -->
    <div class="section" id="education-section">
      <h3>학력사항
              <span class="btn-inline-group" id="edu-button-group" style="display: none;">
                <button type="button" onclick="addEducation()">+ 추가</button>
                <button type="button" onclick="deleteSelectedEdu()">- 삭제</button>
              </span>
      </h3>
      <!-- 안내문구: educationList가 null 아닐 때만 체크 -->
      <p class="info-msg"
         th:if="${profileDto.educationList != null and not #lists.isEmpty(profileDto.educationList.?[(period != null and period != '') or (schoolName != null and schoolName != '') or (major != null and major != '') ])}">
         ※ 불필요한 항목은 삭제해 주세요.
      </p>
      <!-- 항목 제목 라벨 -->
      <div class="edu-header row-group" style="display: flex; gap: 10px; font-weight: bold; margin-bottom: 5px;">
        <label style="width: 220px;">- 기간 -</label>
        <label style="width: 210px;">- 학교명 -</label>
        <label style="width: 200px;">- 학과 -</label>
      </div>
      <!-- "없음" 처리: educationList가 null 아닐 때만 체크 -->
      <div th:if="${profileDto.educationList != null and #lists.isEmpty(profileDto.educationList.?[(period != null and period != '') or (schoolName != null and schoolName != '') or (major != null and major != '')])}">
        <p>없음</p>
      </div>
      <!-- 반복문: null일 때는 미출력 -->
      <th:block th:if="${profileDto.educationList != null}">
        <div th:each="edu,iterStat : ${profileDto.educationList.?[(period != null and period != '') or (schoolName != null and schoolName != '') or (major != null and major != '')]}"
             class="edu-entry">
          <input type="checkbox" class="edu-checkbox" style="display: none;" />
          <input type="text"  th:attr="name=${'educationList[' + iterStat.index + '].period'}" th:value="${edu.period}"       readonly placeholder="기간" />
          <input type="text" th:attr="name=${'educationList[' + iterStat.index + '].schoolName'}" th:value="${edu.schoolName}"   readonly placeholder="학교명" />
          <input type="text" th:attr="name=${'educationList[' + iterStat.index + '].major'}" th:value="${edu.major}"        readonly placeholder="학과" />
          <label>
            <input type="radio" th:attr="name=${'educationList[' + iterStat.index + '].status'}"  value="graduated"  th:checked="${#strings.trim(edu.status) == 'graduated'}"/>
            졸업
          </label>
          <label>
            <input type="radio" th:attr="name=${'educationList[' + iterStat.index + '].status'}"  value="enrolled" th:checked="${#strings.trim(edu.status) == 'enrolled'}"/>
            재학중
          </label>
        </div>
      </th:block>
    </div>
    <!-- 경력사항 -->
    <div class="section" id="work-section">
      <h3>경력사항
              <span class="btn-inline-group" id="work-button-group" style="display: none;">
                <button type="button" onclick="addWork()">+ 추가</button>
                <button type="button" onclick="deleteSelectedWork()">- 삭제</button>
              </span>
      </h3>
      <p class="info-msg"
         th:if="${profileDto.workList != null and not #lists.isEmpty(profileDto.workList.?[(period != null and period != '') or (companyName != null and companyName != '') or (jobResponsibility != null and jobResponsibility != '')])}">
         ※ 불필요한 항목은 삭제해 주세요.
      </p>
      <div class="work-header" style="display: flex; gap: 10px; font-weight: bold; margin-bottom: 5px;">
        <label style="width: 220px;">- 기간 -</label>
        <label style="width: 210px;">- 회사명 -</label>
        <label style="width: 200px;">- 담당 업무 -</label>
      </div>
      <div th:if="${profileDto.workList != null and #lists.isEmpty(profileDto.workList.?[(period != null and period != '') or (companyName != null and companyName != '') or (jobResponsibility != null and jobResponsibility != '')])}">
        <p>없음</p>
      </div>
      <th:block th:if="${profileDto.workList != null}">
        <div th:each="work, iterStat : ${profileDto.workList.?[(period != null and period != '') or (companyName != null and companyName != '') or (jobResponsibility != null and jobResponsibility != '')]}" class="work-entry">
          <input type="checkbox" class="work-checkbox" style="display: none;" />
          <input type="text"   th:attr="name=${'workList[' + iterStat.index + '].period'}" th:value="${work.period}" readonly placeholder="기간" />
          <input type="text"  th:attr="name=${'workList[' + iterStat.index + '].companyName'}"  th:value="${work.companyName}"  readonly placeholder="회사명" />
          <input type="text"th:attr="name=${'workList[' + iterStat.index + '].jobResponsibility'}"   th:value="${work.jobResponsibility}"  readonly  placeholder="담당 업무" />
        </div>
      </th:block>
    </div>
    <!-- 특이사항 -->
    <div class="section">
      <h3>특이사항</h3>
      <textarea
        name="strengths"
        id="strengthsTextarea"
        class="strengths-textarea"
        readonly
        th:text="${profileDto.profile.strengths != null ? profileDto.profile.strengths : ''}"
        placeholder="자격증, 기술능력, 경험 등을 입력"></textarea>
      <p id="strengthsPlaceholder"
         th:if="${profileDto.profile.strengths == null or #strings.isEmpty(profileDto.profile.strengths)}">없음</p>
    </div>
    <p class="timestamp">등록일: <span th:text="${#temporals.format(profileDto.profile.createdAt,'yyyy-MM-dd HH:mm')}"></span></p>
    <p class="timestamp">수정일: <span th:text="${#temporals.format(profileDto.profile.updatedAt,'yyyy-MM-dd HH:mm')}"></span></p>
    <div class="btn-group">
      <div class="btn-left">
        <a th:href="@{/admin/profileList(desiredLocation=${desiredLocation}, nationality=${nationality}, gender=${gender},
          visaType=${visaType}, keyword=${keyword}, page=${pageInfo.currentPage})}" class="btn" id="ListBtn">목록</a>
      </div>
      <div class="btn-right">
        <button th:if="${authorityId == 1 or authorityId == 2}"
                class="btn" id="updateBtn" type="button">수정</button>
        <button th:if="${authorityId == 1 or authorityId == 2}"
                class="btn" id="saveBtn" type="button" style="display: none;">완료</button>
        <button th:if="${authorityId == 1 or authorityId == 2}"
                class="btn" id="cancelBtn"  type="button" style="display: none;">취소</button>
        <button th:if="${authorityId == 1 or authorityId == 2}"
                class="btn" id="deleteBtn" type="button">삭제</button>
      </div>
      <input type="hidden" name="profile.profileId" id="profileId" th:value="${profileDto.profile.profileId}" />
    </div>
</div>
</form>
<footer class="foot-var">
    <div>
        <p>
            <span>(주)한국경영지원사업단  대표이사 : 이준희 <span class="divider">|</span> 사업자등록번호 : 887-81-00124</span><br>
            본사_경기도 김포시 김포한강4로 125 월드타워 705호 <span class="divider">|</span> 본부_경기도 광명시 일직로 43 GIDC A1706호<br>
            국내지사_김해지사, 대구지사, 천안지사, 광주지사, 원주지사 <span class="divider">|</span>
            해외지사_베트남, 필리핀, 인도네시아, 인도, 몽골, 네팔, 우즈베키스탄<br>
            유료직업소개업 등록번호 : 제2025-4090515-14-5-00012호 <span class="divider">|</span>
            Tel_ 031-983-0942 <span class="divider">|</span> Fax_ 031-624-1540 <span class="divider">|</span> Email_ k-jobgo@naver.com<br>
            © 2025 K-jobgo. All rights reserved.
        </p>
    </div>
</footer>
<script th:src="@{/js/common.js}"></script>
<script th:src="@{/js/login.js}"></script>
<script th:src="@{/js/profileDetail.js}"></script>
</body>
</html>
